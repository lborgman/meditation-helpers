<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root * {
            box-sizing: border-box;
        }

        #log {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background-color: gray;
            padding: 2px;
        }

        .inp {
            width: 60px;
        }

        .pop {
            pointer-events: auto;
            background-color: yellow;
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex-grow: 0;
            flex-shrink: 0;
            position: relative;
            overflow-y: auto;
            max-height: calc(100% - 32px);
            max-width: calc(100% - 132px);
            min-width: 200px;
            border-radius: 4px;
            box-shadow: 0px 11px 15px -7px rgba(0, 0, 0, 0.2),
                0px 24px 38px 3px rgba(0, 0, 0, 0.14),
                0px 9px 46px;
        }

        .bgOpen {
            position: fixed;
            left: 0px;
            top: 0px;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 4px dotted red;
        }

        .bgContainer {
            height: 100%;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-around;
            pointer-events: none;
            border: 4px dashed blueviolet;
        }

        #bgOpen1 {
            background-color: burlywood;
        }

        #bgContainer1 {
            background-color: lightcoral;
        }
    </style>
</head>

<body>
    <script>
        function mkElt(type, attrib, inner) {
            var elt = document.createElement(type);

            function addInner(inr) {
                if (inr instanceof Element) {
                    elt.appendChild(inr);
                } else {
                    const txt = document.createTextNode(inr.toString());
                    elt.appendChild(txt);
                }
            }
            if (inner) {
                if (inner.length && typeof inner != "string") {
                    for (var i = 0; i < inner.length; i++)
                        if (inner[i])
                            addInner(inner[i]);
                } else
                    addInner(inner);
            }
            for (var x in attrib) {
                elt.setAttribute(x, attrib[x]);
            }
            return elt;
        }

        function doPopup(txts) {
            const lbl = txts.length.toString();
            const txt = txts.pop();
            const eltInp = mkElt("input", { id: `inp${lbl}`, class: "inp", type: "text" });
            const btnPop = mkElt("button", undefined, `Pop ${lbl}`);
            btnPop.addEventListener("click", evt => {
                // evt.stopPropagation();
                log(`clicked btnPop ${lbl}`);
                doPopup(txts);
            });
            const btnClose = mkElt("button", undefined, "Close");
            const eltPop = mkElt("div", { id: `pop${lbl}`, class: "pop" }, [
                mkElt("div", undefined, txt),
                mkElt("p", undefined, eltInp),
                mkElt("p", undefined, [btnPop, " ", btnClose])
            ]);
            const eltBgContainer = mkElt("div", { id: `bgContainer${lbl}`, class: "bgContainer" }, eltPop);
            const eltBgOpen = mkElt("div", { id: `bgOpen${lbl}`, class: "bgOpen" }, eltBgContainer);

            document.body.appendChild(eltBgOpen);

            btnClose.addEventListener("click", evt => {
                log(`clicked btnClose ${lbl}`);
                eltBgOpen.remove();
            })
            eltBgOpen.addEventListener("click", evt => {
                log(`clicked bg${lbl}`);
            });
            eltPop.addEventListener("click", evt => {
                evt.stopPropagation();
                log(`clicked pop${lbl}`);
            });
        }
        const arrTxts = [
            `Just some text to make pop bigger.
             Just some text to make pop bigger.
             Just some text to make pop bigger.
             Just some text to make pop bigger.
             Just some text to make pop bigger.
            `,
            `
             blaha, bla, bla, bla, goobleigoble,
             blaha, bla, bla, bla, goobleigoble,
             blaha, bla, bla, bla, goobleigoble,
            `
        ];

        doPopup(arrTxts);


        const eltLog = mkElt("div", { id: "log" });
        document.body.appendChild(eltLog);

        function log(msg) {
            eltMsg = mkElt("div", undefined, msg);
            eltLog.appendChild(eltMsg);
        }


    </script>
</body>